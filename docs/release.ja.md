# リリースノート
## Teamstudio Export 4.2
Teamstudio Export 4.2 は Export の機能アップデート版です。PDF文書における表のセルが複数ページにまたがる制限を排除し、ネストしたタブ付きの表が出力できるようになりました。加えて、PDFへの出力の堅牢性と正確性を高める不具合修正や機能拡張があります。

Export 4.0 主のな新機能は以下のとおりです：

* **PDF への出力** - Export は文書を PDF に出力するようになりました。それぞれの PDF へナビゲートするのに使用されるデータベースのビューを HTML サイトとして実装しています。詳細は [PDFへのエクスポート](pdf.md) をご参照ください。この機能は既存のアーカイブがあれば動作します - アーカイブの処理からやり直す必要はありません。
* **非表示設計の式** - もとのデータベース設計が非表示設計の式がある場合でも文書を HTML あるいは PDF に出力するようになりました。Notes クライアント同様、式はディスク上で暗号化（アーカイブ内で）されていますが、表示するかどうか評価されるようになっています。
* **暗号化されたコンテンツ** - Version 4.0.0 から暗号化されたコンテンツをサポートします。添付ファイルも同様です。
   <div class="admonition note">
     <p class="admonition-title">Note</p>
    暗号化されたコンテンツにアクセスする必要がある場合は、3.2.1 以前のバージョンの Export で作成したアーカイブをもう一度再作成する必要があります。アーカイブ実行で使用する ID は、コンテンツを復号化するために必要なキーへのアクセス権を持っている必要があります。アーカイブには復号化されたコンテンツが含まれますので、アーカイブへのアクセスを確保するために必要な措置を取る必要があります。
     </p>
     <p>
     暗号化されたコンテンツがを含まないデータベースを再アーカイブする必要はありません。
     </p>
   </div>

追加の修正は、以下の修正リストのセクションに記載されています。

システム要件とインストールの詳細については [Teamstudio Exportのインストール](installing.md) を参照してください。このページには、既知の問題や不具合修正があれば随時更新されます。

## PDF 出力上の制限
Notes 文書を PDF に変換するのは複雑なプロセスであり、Notes の概念の中には PDF にうまく対応できないものがあります。このセクションでは、現行バージョンでの既知の制限事項をいくつか挙げていますが、これらの問題やその他の問題が発生した場合は、技術サポートチームにご連絡ください。

### 文書リンクと添付ファイル
PDF は、デバイスやビューア間で一貫した表示を提供するという優れた機能を持っていますが、ファイル間のリンクを処理する際には、PDF ビューアによって動作が大きく異なります。残念ながら、すべての環境で完璧に機能するソリューションは現在ありません。私たちのテストでは、ファイルシステムかサーバーホストに出力すれば、相対的なウェブリンクが最も多くのビューアで機能することを確認しています。これが現在デフォルトオプションとして弊社が実装されているソリューションです。出力設定では、PDF 内に添付ファイルを埋め込むオプションがあります。これは、PDF の出力で Export が生成する HTML サイトとは別にこの PDF を利用または配布する場合には最適なオプションかもしれません。ただし、現時点では、ほとんどのブラウザでは埋め込みファイルを表示できないため、Acrobat Reader または Firefox を使用する必要があります。お客様の環境で別のソリューションが必要な場合は、お問い合わせください。

## 不具合修正リスト
### Export 4.2.0
[TMS-1428] - 不正な画像イメージがによってPDF出力を中断される問題を修正  
[TMS-1431] - US Letter の PDF ページの高さが正しくない問題を修正  
[TMS-1432] - 不正な数値によってHTML/PDF出力で InvalidOperationException が発生する問題を修正  
[TMS-1433] - 'weekday' の日付フォーマットのサポートを追加  
[TMS-1434] - NotesBitmap イメージのサポートを追加  
[TMS-1435] - PDF内の外部への文書リンクがPDFディレクトリーではなくHTMLディレクトリーをターゲットにしていた問題を修正  
[TMS-1436] - インストーラーの署名が 2021 年5月に期限切れとなる問題を修正  
[TMS-1438] - 空の日付時刻フォーマットで 'The format string is empty' エラーでビューに書き込まれる問題を修正  
[TMS-1439] - 添付ファイル短縮名に変換するマップファイルが元々の名前で書き込まれる問題を修正  
[TMS-1440] - 式内の空の文字列による文字列比較が正しくなかった問題を修正  
[TMS-1441] - PDF 出力が暗号化された式を操作できなかった問題を修正  
[TMS-1443] - 計算結果テキストが単なるテキストだけでなく数値と日付としても表示するように修正  
[TMS-1444] - アーカイブがネットワークドライブに存在している場合に間欠 XML パースエラーが発生する問題を修正  
[TMS-1445] - 文書上の共有リッチテキストフィールドがPDF生成で失敗に終わる問題を修正  
[TMS-1446] - PDF内の表のセルが複数ページにまたがったり切れたりする問題を修正  
[TMS-1447] - 画像イメージの表示の大きさをユーザーによって操作されたものを正しく表示するよう修正  
[TMS-1448] - PDFで A3 サイズと横向きのページのサポートを追加  
[TMS-1449] - アーカイブ中に 'Error decompressing bitmap segment' に対する操作の改善  
[TMS-1450] - PDF でネストした表が親のセルの colspan に準拠しない問題を修正  

### Export 4.1.0
[TMS-1409] - 名前に引用符などを含む欠落したサブフォームを参照しているフォームを PDF に出力する際にエラーが発生する問題を修正  
[TMS-1410] - @Repeat のサポートを追加  
[TMS-1411] - PDF の表の列が右マージンにはみ出すことがある問題を修正  
[TMS-1412] - フォームが利用できない場合に作成したPDF の表に不要なバッククォートが付く問題を修正  
[TMS-1413] - 式での日付時間の減算をサポート  
[TMS-1414] - 境界線のある PDF のセクションヘッダが段落スタイルに関係なく常に左揃えになる問題を修正  
[TMS-1415] - 文書で TrueType Collection フォントからローカライズされた名前のフォントを参照すると、PDFの書き出しが失敗する問題を修正  
[TMS-1416] - HTML と PDF で EmbeddedControl 要素のサポートを追加  
[TMS-1417] - 固定幅の列がページ幅を超えている場合、PDF出力が幅の狭い列に多くの幅を割り当てるように修正  
[TMS-1418] - 全文索引がデータに大きな base64 テキストフィールドが含まれている場合に大きく肥大化する問題を修正  
[TMS-1419] - アーカイブのログが、アーカイブがデモモードでビルドしたかどうかを判別できるように修正  
[TMS-1420] - シリアル番号とキーが提供されていない場合はデモモードで実行できるように修正  
[TMS-1421] - 表示上の計算結果が、文書内にすでに存在する場合には評価しないように修正  
[TMS-1422] - @ThisName のサポートを追加  

### Export 4.0.1
[TMS-1400] - 参照がない添付ファイルへのPDF上のリンクがウェブ上で動作しない問題を修正  
[TMS-1401] - PDF に埋め込まれた添付ファイルをサポートし、オプション設定で有効にできるように機能を追加  
[TMS-1402] - ログをクリップボードにコピーすると、0x800401D0 で失敗して Export がクラッシュする問題を修正  
[TMS-1403] - PDF で 添付の表示名をファイル拡張子を保持したまま使用することができるよう修正  
[TMS-1404] - 添付ファイルのサイズが無効なため、HTML の出力に失敗する問題を修正  
[TMS-1405] - 文書にバッククォートの文字列が含まれていると PDF 出力に失敗する問題を修正  
[TMS-1406] - ネストされた表が幅を計算する際に左マージンを無視するように修正  
[TMS-1407] - 表の内部にあるサブフォーム上の表の幅が間違っていた問題を修正  
[TMS-1408] - Internet Explorer を使用時に空のページで失敗する(Export 4.0.0)問題を修正  