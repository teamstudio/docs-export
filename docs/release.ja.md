# リリースノート
## Teamstudio Export 4.5.1
Teamstudio Export 4.5.1 はメンテナンスアップデート版で、数多くの不具合修正と機能拡張が含まれています。

Export 4.5 の主要な新機能は以下のとおりです:

* **OLE のサポート** - Export は埋め込み Microsoft Office の OLE オブジェクトを展開できるようになりました。 Word, Excel, PowerPoint をサポートし、古い形式の .doc、.xls、 .ppt の形式はもちろん .docx、.xlsx、.pptx の形式もサポートします。その他の文書タイプについては現在展開されません。追加でその他の OLE オブジェクトタイプのサポートが必要な場合には弊社までご連絡ください。

* **データベースレベルの設定** - アプリケーションの中には、@UserRoles を使用した非表示式を用いてフォームのある部分にコンテンツを表示するかしないかを制御するものがあります。以前のバージョンの Export では、@UserRoles に対して常に空のリストが返さざるを得ず正しく出力することができませんでした。ユーザーロールはデータベースによってそれぞれ異なり固有であるため、Export 内のグローバル構成で設定することは何の意味もありませんでした。Export 4.5 では、@UserRoles によって返されるロールをデータベースごとに設定する機能が追加され、必要に応じて出力を調整できるようになりました。これらの設定は、PDF または HTML 出力の *config* フォルダに保存され、同じデータベースの次回以降の出力にも再利用されます。稀にしか必要としませんが、@UserName の値や、@Environment を用いて notes.ini からの取得していた値も設定できます。

追加された不具合修正は以下の不具合修正リストよりご確認ください。

Export 4.5 で追加された新機能や不具合修正をご利用いただくのに改めてデータベースをアーカイブから作成し直すことは必要ありません。

システム要件やインストール方法の詳細については [Installing Teamstudio Export](installing.md) をご参照ください。このページには既知の問題や利用可能になった不具合修正が掲載されています。

## 不具合修正リスト
### Export 4.5.1
[185642000]	@Text における '\*' フォーマットのサポートを追加  
[185659716]	サポートファイルの生成時に基本ビューの追加  
[185894864]	onread="collapse" セクションの機能改善  
[185769401]	imagemaps のサポートを追加  
[186028370]	読み込みモードあるいは印刷モードでの出力を追加  
[186043382]	不正な検索一致ハイライトがイメージを破損させる問題を修正  
[186205126]	noteid によるサポートファイル生成時にハングする事象を改善  
[186216769]	Excel 5 OLE オブジェクトのサポートを追加  
[186267662]	"Word.Document" OLE タイプの操作を改善  
[186288032]	埋め込み添付ファイルのある文書を PDF 出力する際にエラーとなる現象を修正  
[186326438]	ノーツ式内の % の文字をサポートするように修正  
[186489298]	サポートファイルエントリーに対する複数の説明ができるように修正  
[186488956]	サポートファイル内に埋め込みビューが含まれていなかった問題を修正  
[186572669]	@Adjust が OverflowException でエラーとなる問題を修正  
[186751698]	埋め込みビュー内のイメージリソースアイコンのサポートを追加  
[186754146]	@Middle のエッジケースを改善  
[186759675]	セルの背景イメージの repeat="center" のサポートを追加  
[186775545]	@GetField が空のリスト引数でエラーとなる問題を修正  
[186775840]	段落中のキーワードフィールドの配置の改善  
[186813576]	サポートファイルにプロフィール文書を含めるように修正  
[186864681]	非対の (\*) 演算子が不正な結果を返す問題を修正  
[187005613]	OpenExportFileWrite がロード中にエラーとなる問題を修正  
[187013849]	ビュー属性を持たない文書リンクの操作を修正  
[187015303]	タブ付き表が HTML 上で固定幅が指定通りにならなかった問題を修正  
[187056924]	全てのセクションを展開するオプションを追加  
[187093492]	OLE1 オブジェクトのサポートを追加  
[187100941]	"ExcelWorksheet" オブジェクトタイプのサポートを追加  
[187128050]	@Abstract のリッチテキストに対する操作の基本的な機能の改善

### Export 4.5.0
[184587425]	欠如する $File アイテムの操作における改善 
[184578743]	フォーム/サブフォーム内の添付ファイルにおける操作の改善  
[184633099]	サポートしていない「年」の形式における操作の改善  
[184666006]	PDF 内のタブ付き表における行間操作の改善  
[184690086]	@UserName、@UserRoles、@Environment に対するデータベースレベルでの設定のサポート  
[184764016]	空の文書をプレビューしないように修正  
[184763654]	セクション内の 'onread' = 'collapse' のサポート  
[184764830]	@DbLookup 内で文書が見つからなかった際の操作の改善  
[184835589]	バイナリービットマップ内の破損に対する操作の改善  
[184836217]	meta.xml が BOM 情報なしでも出力するように改善  
[184847648]	変換中に不正な段落でエラーになる問題を修正  
[184873442]	files.xml 内にアイテム名を含めるよう修正  
[184873262]	参照情報のない添付ファイル名が PDF で正しく表示されない問題を修正  
[184873249]	参照情報のない添付ファイル検知を改善  
[184884947]	バイナリーリッチテキスト内の 0 長レコードでエラーとなる問題を修正  
[184893394]	段落内部の不正な段落でエラーになる問題を修正  
[184972331]	@GetDocField のサポート  
[184992361]	インストーラーでデスクトップショートカットを作成する機能を追加  
[184992632]	設定ダイアログでよりわかるやすい言い回しに改良  
[185047386]	データベースを跨ぐ埋め込みビューのサポート  
[185086409]	返答文書に $REF アイテムをセットするように改善  
[185086023]	dxl 内の TYPE\_NOTEREF\_LIST アイテムをサポート  
[185103812]	'weekday' のカスタム日付フォーマットをサポート  
[185131124]	コード署名認証者の更新に関する修正  
[185140992]	格納フォーム上の添付ファイルに対する NPE を修正  
[185141852]	破損した OLE オブジェクトファイルを無視するよう修正  
[185142986]	セグメントのない OLE オブジェクトファイルを無視するように修正  
[185152697]	バイナリーリッチテキスト内の破損した表の操作を改善  
[185216262]	バイナリーリッチテキスト内の段落外にある添付ファイル参照の操作を修正  
[185249056]	より長い PDF 文書が作成できるように修正  
[185249094]	PDF 作成時のパフォーマンスを上げるため MigradocXML 内のスタイルサポートを無効  
[185250993]	DXL 表内での誤実行の操作を改善  
[185252245]	非表示の Excel OLE オブジェクトの操作を改善  
[185260169]	@Text 内のリッチテキストに対する基本的なサポート  
[185260108]	PDF 内で正しく表示されない段落内のプレーンテキストに関する修正  
[185297670]	@DbLookup でビューがサポートファイルに常に追加されなかった問題を修正  
[185316756]	@DbLookup 内でビューの数値の値を @ERROR で返される操作の修正  
[185358166]	@ThisName がキーワードの式で使用できるように修正  
[185466971]	バイナリーリッチテキストの終わりにあるネストした添付ファイルの操作を改善  
[185525338]	計算結果フィールドが文書上になくても評価されるように修正  
[185577528]	式のない計算結果フィールドの操作を修正  
[185578342]	'day' カスタム日付フォーマットのサポート  
[185579036]	エラーログにタイムスタンプの追加  
[185592149]	1桁の day/month カスタム日付フォーマットにおける問題を修正
